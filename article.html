<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ù„Ø¹</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg1:#070517;
  --bg2:#120a2a;
  --card:#0e0a1f;
  --stroke:rgba(255,255,255,.08);
  --text:#f1f5f9;
  --muted:rgba(241,245,249,.7);
  --mauve:#b55cff;
  --mauve2:#7c3aed;
  --good:#22c55e;
  --warn:#f97316;
  --bad:#ef4444;
  --shadow:0 25px 60px rgba(0,0,0,.55);
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:'Cairo',Tahoma;
  background:
    radial-gradient(900px 500px at 15% 10%, rgba(181,92,255,.25), transparent 60%),
    linear-gradient(135deg,var(--bg1),var(--bg2));
  color:var(--text);
  min-height:100vh;
}

.container{
  max-width:1200px;
  margin:30px auto;
  padding:20px;
}

.header{
  background:linear-gradient(135deg, rgba(181,92,255,.18), rgba(14,10,31,.7));
  border:1px solid var(--stroke);
  border-radius:18px;
  padding:18px;
  box-shadow:var(--shadow);
  display:flex;
  justify-content:space-between;
  align-items:center;
  flex-wrap:wrap;
  gap:10px;
}

.header h1{
  margin:0;
  font-size:22px;
  font-weight:800;
}

.back{
  background:linear-gradient(135deg,var(--mauve),var(--mauve2));
  border:none;
  color:white;
  padding:10px 16px;
  border-radius:14px;
  font-weight:800;
  cursor:pointer;
}

.stats{
  margin-top:20px;
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:15px;
}

.stat{
  background:rgba(14,10,31,.7);
  border:1px solid var(--stroke);
  border-radius:16px;
  padding:16px;
  box-shadow:var(--shadow);
}

.stat span{
  display:block;
  font-size:13px;
  color:var(--muted);
}

.stat strong{
  font-size:22px;
  font-weight:900;
  color:var(--mauve);
}

.search{
  margin-top:20px;
}

.search input{
  width:100%;
  padding:14px 16px;
  border-radius:16px;
  border:1px solid var(--stroke);
  background:rgba(255,255,255,.05);
  color:white;
  font-family:'Cairo';
  font-size:15px;
}

.table-card{
  margin-top:20px;
  background:rgba(14,10,31,.7);
  border:1px solid var(--stroke);
  border-radius:18px;
  overflow:hidden;
  box-shadow:var(--shadow);
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}

th,td{
  padding:12px;
  border-bottom:1px solid #1f2937;
  text-align:center;
}

th{
  background:#020617;
  font-weight:800;
}

tr:hover{
  background:rgba(181,92,255,.08);
}

/* ğŸŸ  ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù„Ø¹ØªØ¨Ø© */
.low-stock{
  background:rgba(249,115,22,.18);
}

/* ğŸ”´ Ù†ÙØ§Ø¯ */
.out-stock{
  background:rgba(239,68,68,.25);
  font-weight:800;
}

.loading,.error{
  text-align:center;
  padding:30px;
  font-size:16px;
}

.error{color:#f87171}

footer{
  margin-top:25px;
  text-align:center;
  font-size:12px;
  opacity:.6;
}
</style>
</head>

<body>

<div class="container">

  <div class="header">
    <h1>ğŸ“¦ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ù„Ø¹</h1>
    <button class="back" onclick="location.href='index.html'">â¬… Ø§Ù„Ø±Ø¬ÙˆØ¹</button>
  </div>

  <div class="stats">
    <div class="stat">
      <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ù„Ø¹</span>
      <strong id="nbArticles">â€”</strong>
    </div>
  </div>

  <div class="search">
    <input type="text" id="searchInput" placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø£Ùˆ Ø§Ù„ØªØ¹ÙŠÙŠÙ†...">
  </div>

  <div id="loading" class="loading">â³ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ù„Ø¹...</div>
  <div id="error" class="error" style="display:none"></div>

  <div class="table-card">
    <table id="articleTable" style="display:none">
      <thead>
        <tr>
          <th>Ø§Ù„Ù…Ø±Ø¬Ø¹</th>
          <th style="text-align:right">Ø§Ù„ØªØ¹ÙŠÙŠÙ†</th>
          <th>Ø³Ø¹Ø± Ø§Ù„Ø´Ø±Ø§Ø¡</th>
          <th>Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹</th>
          <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

</div>

<footer>
ProBMS Â© www.bmsoftdev.com â€” 06.62.54.14.86 / 07.76.07.77.94
</footer>

<script>
const ARTICLE_URL = "article.json";
let allItems = [];

function format00(v){
  return Number(v).toLocaleString('fr-FR',{minimumFractionDigits:2});
}

function renderTable(items){
  const tbody = document.querySelector("#articleTable tbody");
  tbody.innerHTML = "";

  items.forEach(a=>{
    const tr = document.createElement("tr");

    if(a.qte <= 0){
      tr.classList.add("out-stock");
    }else if(a.qte <= a.alerte){
      tr.classList.add("low-stock");
    }

    tr.innerHTML = `
      <td>${a.reference}</td>
      <td style="text-align:right">${a.designation}</td>
      <td>${format00(a.achat)}</td>
      <td style="font-weight:800">${format00(a.vente)}</td>
      <td>${a.qte}</td>
    `;
    tbody.appendChild(tr);
  });
}

fetch(ARTICLE_URL)
  .then(r=>r.json())
  .then(data=>{
    document.getElementById("loading").style.display="none";
    document.getElementById("nbArticles").innerText = data.articles;

    allItems = data.items;
    renderTable(allItems);

    document.getElementById("articleTable").style.display="table";
  })
  .catch(err=>{
    document.getElementById("loading").style.display="none";
    document.getElementById("error").style.display="block";
    document.getElementById("error").innerText="âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø³Ù„Ø¹";
    console.error(err);
  });

document.getElementById("searchInput").addEventListener("input", function(){
  const q = this.value.toLowerCase();
  const filtered = allItems.filter(a =>
    a.reference.toLowerCase().includes(q) ||
    a.designation.toLowerCase().includes(q)
  );
  renderTable(filtered);
});
</script>

</body>
</html>
